(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{544:function(a,t,s){"use strict";s.r(t);var e=s(30),r=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"javaagent-应用指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javaagent-应用指南"}},[a._v("#")]),a._v(" JavaAgent 应用指南")]),a._v(" "),s("p",[a._v("Javaagent 是什么？")]),a._v(" "),s("p",[a._v("Javaagent 是 java 命令的一个参数。参数 javaagent 可以用于指定一个 jar 包，它利用 JVM 提供的 Instrumentation API 来更改加载 JVM 中的现有字节码。")]),a._v(" "),s("ol",[s("li",[a._v("这个 jar 包的 MANIFEST.MF 文件必须指定 Premain-Class 项。")]),a._v(" "),s("li",[a._v("Premain-Class 指定的那个类必须实现 premain() 方法。")])]),a._v(" "),s("p",[a._v("premain 方法，从字面上理解，就是运行在 main 函数之前的的类。当 Java 虚拟机启动时，在执行 main 函数之前，JVM 会先运行"),s("code",[a._v("-javaagent")]),a._v("所指定 jar 包内 Premain-Class 这个类的 premain 方法 。")]),a._v(" "),s("p",[a._v("在命令行输入 "),s("code",[a._v("java")]),a._v("可以看到相应的参数，其中有 和 java agent 相关的：")]),a._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("-agentlib:"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("libname"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\t\t\t  加载本机代理库 "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("libname"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(", 例如 -agentlib:hprof\n\t\t\t  另请参阅 -agentlib:jdwp"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("help 和 -agentlib:hprof"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("help\n-agentpath:"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("pathname"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\t\t\t  按完整路径名加载本机代理库\n-javaagent:"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("jarpath"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("选项"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n\t\t\t  加载 Java 编程语言代理, 请参阅 java.lang.instrument\n")])])]),s("h2",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[a._v("#")]),a._v(" 参考资料")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://docs.oracle.com/javase/7/docs/api/java/lang/instrument/package-summary.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("java.lang.instrument"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=r.exports}}]);